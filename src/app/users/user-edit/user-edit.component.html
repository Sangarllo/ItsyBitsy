<mat-toolbar color="primary">
    <span>{{pageTitle}}</span>
    <span class="fill-remaining-space"></span>
    <button mat-raised-button color="accent" (click)="goBack()">Volver</button>
</mat-toolbar>

<mat-card>

    <form [formGroup]="userDetailsForm" class="form-container" (ngSubmit)="onSaveForm()">

        <div class="row">
            <div class="col-lg-6 col-12" style="text-align: center;">
                <img [src]="userDetailsForm.get('photoURL').value" style="height:80%" />

                <mat-form-field>
                    <mat-label>Avatar</mat-label>
                    <mat-select formControlName="photoURL" [value]="userDetailsForm.get('photoURL').value">
                        <mat-option *ngFor="let avatar of AVATARES" [value]="avatar.path">
                            {{avatar.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>

                <mat-card-content>
                    <mat-label>Roles</mat-label>
                    <br/>
                    <mat-checkbox color="warn" disabled class="checkbox-margin" formControlName="isUser">Está registrado</mat-checkbox>
                    <mat-checkbox color="warn" class="checkbox-margin" formControlName="isAdmin">Es admin</mat-checkbox>
                    <mat-checkbox color="warn" class="checkbox-margin" formControlName="isTeacher">Es profesor</mat-checkbox>
                    <mat-checkbox color="warn" class="checkbox-margin" formControlName="isStudent">Es estudiante</mat-checkbox>
                </mat-card-content>

            </div>

            <div class="col-lg-6 col-12">

                <mat-card-content>

                    <h5>Datos Personales</h5>
                    <br/>

                    <div class="container">
                        <div class="row">
                            <mat-form-field class="col-6">
                                <input matInput type="text" formControlName="displayName" placeholder="Nombre Completo">
                            </mat-form-field>

                            <mat-form-field class="col-6">
                                <input matInput type="text" formControlName="nickName" placeholder="Nombre de usuario">
                            </mat-form-field>
                        </div>
                        <div class="row">
                            <mat-form-field class="col-6">
                                <input matInput type="text" formControlName="location" placeholder="Localidad">
                            </mat-form-field>

                            <mat-form-field class="col-6">
                                <input matInput [matDatepicker]="picker" formControlName="birthday" placeholder="Fecha de Cumpleaños">
                                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                <mat-datepicker #picker startView="multi-year"></mat-datepicker>
                            </mat-form-field>
                        </div>
                    </div>

                    <mat-divider></mat-divider>

                    <br/>
                    <h5>Datos de Contacto</h5>
                    <br/>

                    <div class="container">
                        <div class="row">

                            <mat-form-field class="col-12">
                                <input matInput type="text" formControlName="email" placeholder="Correo Electrónico">
                                <mat-error *ngIf="!!userDetailsForm.get('email').hasError('required')">{{ errorMessage }}</mat-error>
                            </mat-form-field>

                            <mat-form-field class="col-6">
                                <input matInput type="text" formControlName="contactPerson" placeholder="Persona de Contacto">
                            </mat-form-field>

                            <mat-form-field class="col-6">
                                <input matInput type="text" formControlName="telephone" placeholder="Teléfono de Contacto">
                            </mat-form-field>
                        </div>
                    </div>

                    <mat-divider></mat-divider>

                    <br/>
                    <h5>Datos de Facturación</h5>
                    <br/>

                    <div class="container">
                        <div class="row">

                            <mat-form-field class="col-12" *ngIf="rates$ | async as RATES">
                                <mat-label>Tarifa</mat-label>
                                <mat-select formControlName="rateId" [value]="userDetailsForm.get('rateId').value">
                                    <mat-option *ngFor="let rate of RATES" [value]="rate.id">
                                        {{rate.name}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>

                            <mat-form-field class="col-12">
                                <input matInput type="text" formControlName="paymentMethod" placeholder="Método de pago">
                            </mat-form-field>
                        </div>
                    </div>

                </mat-card-content>

            </div>
        </div>

        <div class="row">

            <div class="col-12">

                <mat-card-actions>
                    <button mat-raised-button [title]="userDetailsForm.valid ? 'Guardar con los datos introducidos' : 'Dishabilitado hasta que los datos sean válidos'" [disabled]="!userDetailsForm.valid" type="submit" color="primary">Guardar</button>
                    <button mat-raised-button type="button" (click)="goBack()" color="primary">Volver sin guardar</button><button mat-raised-button type="button" (click)="gotoList()" color="primary">Ver Usuarios</button>
                </mat-card-actions>
            </div>

        </div>

    </form>

</mat-card>